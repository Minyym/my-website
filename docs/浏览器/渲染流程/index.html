<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">渲染流程 | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://Minyym.github.io/my-website/docs/浏览器/渲染流程"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="渲染流程 | My Site"><meta data-react-helmet="true" name="description" content="渲染流程"><meta data-react-helmet="true" property="og:description" content="渲染流程"><link data-react-helmet="true" rel="shortcut icon" href="/my-website/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://Minyym.github.io/my-website/docs/浏览器/渲染流程"><link data-react-helmet="true" rel="alternate" href="https://Minyym.github.io/my-website/docs/浏览器/渲染流程" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://Minyym.github.io/my-website/docs/浏览器/渲染流程" hreflang="x-default"><link rel="stylesheet" href="/my-website/assets/css/styles.6f0efc76.css">
<link rel="preload" href="/my-website/assets/js/runtime~main.c5cb8cc9.js" as="script">
<link rel="preload" href="/my-website/assets/js/main.1b81e99a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-website/"><b class="navbar__title">xiaojingyu</b></a><a class="navbar__item navbar__link navbar__link--active" href="/my-website/docs/JS基础/new">JS</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Minyym/my-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CSS&amp;HTML</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ES</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">GIT</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">JS基础</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">TS</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">babel</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">npm&amp;node</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">react</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">skills</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">webpack</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">前端基建</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">小程序</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">浏览器</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/my-website/docs/浏览器/导航流程">导航流程</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/my-website/docs/浏览器/渲染流程">渲染流程</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/my-website/docs/浏览器/HTTP协议">HTTP协议</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/my-website/docs/浏览器/OSI和TCPIP模型">OSI和TCPIP模型</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/my-website/docs/浏览器/垃圾回收">垃圾回收</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/my-website/docs/浏览器/XMLHttpRequest">XMLHttpRequest</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/my-website/docs/浏览器/任务分片">任务分片</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">算法</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">计算机组成原理</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">设计模式</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">面试</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>渲染流程</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="渲染流程"></a>渲染流程<a class="hash-link" href="#渲染流程" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="总流程"></a>总流程<a class="hash-link" href="#总流程" title="Direct link to heading">#</a></h3><ol><li>渲染进程将 HTML 内容转换为能够读懂的 DOM 树结构。</li><li>渲染引擎将 CSS 样式表转化为浏览器可以理解的 styleSheets，计算出 DOM 节点的样式。</li><li>创建布局树，并计算元素的布局信息。</li><li>对布局树进行分层，并生成分层树。</li><li>为每个图层生成绘制列表，并将其提交到合成线程。</li><li>合成线程将图层分成图块，并在光栅化线程池中将图块转换成位图。</li><li>合成线程发送绘制图块命令 DrawQuad 给浏览器进程。</li><li>浏览器进程根据 DrawQuad 消息生成页面，并显示到显示器上。</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="css样式计算"></a>css样式计算<a class="hash-link" href="#css样式计算" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="css样式的来源"></a>css样式的来源<a class="hash-link" href="#css样式的来源" title="Direct link to heading">#</a></h4><ol><li>link引用的外部文件</li><li>style标签内的文件</li><li>元素的 style 属性内嵌的 CSS</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="css样式内属性值标准化"></a>css样式内属性值标准化<a class="hash-link" href="#css样式内属性值标准化" title="Direct link to heading">#</a></h4><ul><li>需要将所有值转换为渲染引擎容易理解的、标准化的计算值</li><li>例如：2em---32px red---rgb（）</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="计算出每个元素的具体样式"></a>计算出每个元素的具体样式<a class="hash-link" href="#计算出每个元素的具体样式" title="Direct link to heading">#</a></h4><ul><li>CSS 的继承规则和层叠规则</li><li>CSS 继承就是每个 DOM 节点都包含有父节点的样式</li><li>UserAgent 样式，它是浏览器提供的一组默认样式，如果你不提供任何样式，默认使用的就是 UserAgent 样式。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="布局阶段"></a>布局阶段<a class="hash-link" href="#布局阶段" title="Direct link to heading">#</a></h3><ol><li>创建布局树<ul><li>遍历 DOM 树中的所有可见节点，并把这些节点加到布局树中；</li><li>而不可见的节点会被布局树忽略掉，属性包含 dispaly:none的元素也没有被包进布局树</li></ul></li><li>布局计算，到这里我们的每个节点都拥有了自己的样式和布局信息</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="分层"></a>分层<a class="hash-link" href="#分层" title="Direct link to heading">#</a></h3><p>渲染引擎还需要为特定的节点生成专用的图层，并生成一棵对应的图层树（LayerTree）</p><ol><li><p>拥有层叠上下文属性的元素会被提升为单独的一层。</p></li><li><p>需要剪裁（clip）的地方也会被创建为图层。</p><p>在这里我们把 div 的大小限定为 200 <em> 200 像素，而 div 里面的文字内容比较多，文字所显示的区域肯定会超出 200 </em> 200 的面积，这时候就产生了剪裁，渲染引擎会把裁剪文字内容的一部分用于显示在 div 区域。</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="图层绘制"></a>图层绘制<a class="hash-link" href="#图层绘制" title="Direct link to heading">#</a></h3><ol><li>渲染引擎实现图层的绘制与之类似，会把一个图层的绘制拆分成很多小的绘制指令，然后再把这些指令按照顺序组成一个待绘制列表</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="栅格化操作"></a>栅格化操作<a class="hash-link" href="#栅格化操作" title="Direct link to heading">#</a></h3><ul><li>绘制列表只是用来记录绘制顺序和绘制指令的列表，而实际上绘制操作是由渲染引擎中的合成线程来完成的。</li><li>合成线程会将图层划分为图块（tile），这些图块的大小通常是 256x256 或者 512x512</li><li>然后合成线程会按照视口附近的图块来优先生成位图，实际生成位图的操作是由栅格化来执行的。所谓栅格化，是指将图块转换为位图。而图块是栅格化执行的最小单位。渲染进程维护了一个栅格化的线程池，所有的图块栅格化都是在线程池内执行的</li><li>通常，栅格化过程都会使用 GPU 来加速生成，使用 GPU 生成位图的过程叫快速栅格化，或者 GPU 栅格化，生成的位图被保存在 GPU 内存中。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="合成和显示"></a>合成和显示<a class="hash-link" href="#合成和显示" title="Direct link to heading">#</a></h3><ol><li><p>一旦所有图块都被光栅化，合成线程就会生成一个绘制图块的命令——“DrawQuad”，然后将该命令提交给浏览器进程。</p></li><li><p>浏览器进程里面有一个叫 viz 的组件，用来接收合成线程发过来的 DrawQuad 命令，然后根据 DrawQuad 命令，将其页面内容绘制到内存中，最后再将内存显示在屏幕上。</p></li><li><p>到这里，经过这一系列的阶段，编写好的 HTML、CSS、JavaScript 等文件，经过浏览器就会显示出漂亮的页面了。</p></li></ol><p>   <img src="https://files.catbox.moe/f21slr.webp"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="v8-是如何执行一段-javascript-代码的"></a>V8 是如何执行一段 JavaScript 代码的<a class="hash-link" href="#v8-是如何执行一段-javascript-代码的" title="Direct link to heading">#</a></h2><p><img src="https://raw.githubusercontent.com/Minyym/figure-bed/master/img/202304121805464.png"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Minyym/my-website/edit/master/docs/浏览器/2.渲染流程.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/my-website/docs/浏览器/导航流程"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 导航流程</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/my-website/docs/浏览器/HTTP协议"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">HTTP协议 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#渲染流程" class="table-of-contents__link">渲染流程</a><ul><li><a href="#总流程" class="table-of-contents__link">总流程</a></li><li><a href="#css样式计算" class="table-of-contents__link">css样式计算</a></li><li><a href="#布局阶段" class="table-of-contents__link">布局阶段</a></li><li><a href="#分层" class="table-of-contents__link">分层</a></li><li><a href="#图层绘制" class="table-of-contents__link">图层绘制</a></li><li><a href="#栅格化操作" class="table-of-contents__link">栅格化操作</a></li><li><a href="#合成和显示" class="table-of-contents__link">合成和显示</a></li></ul></li><li><a href="#v8-是如何执行一段-javascript-代码的" class="table-of-contents__link">V8 是如何执行一段 JavaScript 代码的</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/my-website/assets/js/runtime~main.c5cb8cc9.js"></script>
<script src="/my-website/assets/js/main.1b81e99a.js"></script>
</body>
</html>