"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4203],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>d});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),p=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(i.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},k=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(t),k=a,d=c["".concat(i,".").concat(k)]||c[k]||m[k]||s;return t?r.createElement(d,o(o({ref:n},u),{},{components:t})):r.createElement(d,o({ref:n},u))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=k;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<s;p++)o[p]=t[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}k.displayName="MDXCreateElement"},247:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>o,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>i});var r=t(7462),a=(t(7294),t(3905));const s={},o="axios",l={unversionedId:"\u9762\u8bd5/axios",id:"\u9762\u8bd5/axios",isDocsHomePage:!1,title:"axios",description:"`JS",source:"@site/docs/\u9762\u8bd5/10.axios.md",sourceDirName:"\u9762\u8bd5",slug:"/\u9762\u8bd5/axios",permalink:"/my-website/docs/\u9762\u8bd5/axios",editUrl:"https://github.com/Minyym/my-website/edit/master/docs/\u9762\u8bd5/10.axios.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u79fb\u52a8\u7aef",permalink:"/my-website/docs/\u9762\u8bd5/\u79fb\u52a8\u7aef"},next:{title:"react",permalink:"/my-website/docs/\u9762\u8bd5/react"}},i=[],p={toc:i},u="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"axios"},"axios"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-JS"},"/*\n  1. \u4e3a\u4ec0\u4e48axios\u65e2\u80fd\u5f53\u505a\u51fd\u6570\u8c03\u7528\uff0c\u4e5f\u80fd\u5f53\u505a\u5bf9\u8c61\u4f7f\u7528\uff1f\n    axios({}) --\x3e instance({}) --\x3e request({})\n      \u56e0\u4e3a\u6539\u53d8\u4e86this\u6307\u5411\uff0c\u6240\u4ee5this\u6307\u5411context\uff08\u5c31\u662fAxios\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff09\n    axios.get(url)\n      \u5c06Axios.prototype\u7684\u65b9\u6cd5\u590d\u5236\u5230instance\uff08axios\uff09\u4e0a\n      utils.extend(instance, Axios.prototype, context);\n      \n  2. Axios \u548c axios \u4e4b\u95f4\u7684\u8054\u7cfb\n    axios\u662f\u4e0d\u662fAxios\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff1f\u4e0d\u662f\uff0ccontext\u624d\u662f\n    \u4f46\u662faxios\u6709Axios\u4e0a\u7684\u65b9\u6cd5\uff08\u4e0eAxios\u5b9e\u4f8b\u529f\u80fd\u5f88\u76f8\u4f3c\uff0c\u4f46\u4e0d\u5b8c\u5168\u4e00\u6837\uff09\n\n  3. axios\u7684\u529f\u80fd\n    \u672c\u8eab\u662f\u4e00\u4e2arequest\u51fd\u6570\n    \u6709 get\u3001post...\u7b49\u65b9\u6cd5\n    \u6709 defaults\u3001interceptors\u7b49\u5c5e\u6027\n    \u6709 create \u3001all\u3001Cancel \u7b49\u65b9\u6cd5\n\n  4. axios\u548caxios.create()\u8fd4\u56de\u7684axios\u6709\u4ec0\u4e48\u533a\u522b\uff1f\n    \u672c\u8eab\u662f\u4e00\u4e2arequest\u51fd\u6570\n    \u6709 get\u3001post...\u7b49\u65b9\u6cd5\n    \u6709 defaults\u3001interceptors\u7b49\u5c5e\u6027\n\n    \u6ca1\u6709 create \u3001all\u3001Cancel \u7b49\u65b9\u6cd5\n*/\n")),(0,a.kt)("h4",{id:"\u4f7f\u7528xhr\u5c01\u88c5axios"},"\u4f7f\u7528xhr\u5c01\u88c5axios"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-JS"},'function axios({\n        method, // \u8bf7\u6c42\u65b9\u5f0f\n        url, // \u8bf7\u6c42\u5730\u5740\n        data, // \u8bf7\u6c42\u4f53\u53c2\u6570 body\n        params, // querystring \u67e5\u8be2\u5b57\u7b26\u4e32\u53c2\u6570\n      }) {\n        return new Promise((resolve, reject) => {\n          method = method.toUpperCase();\n          // 1. \u521b\u5efaxhr\u5bf9\u8c61\n          const xhr = new XMLHttpRequest();\n          // 2. \u7ed1\u5b9aonreadystatechange\u4e8b\u4ef6\n          // \u5f53readystate\u53d1\u751f\u53d8\u5316\u65f6\u89e6\u53d1\u7684\u4e8b\u4ef6\n          xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n              // \u54cd\u5e94\u8fd4\u56de\u4e86\uff08\u4f46\u662f\u6210\u529f\u3001\u5931\u8d25\u4e0d\u77e5\u9053\uff09\n              if (xhr.status >= 200 && xhr.status < 300) {\n                // \u54cd\u5e94\u6210\u529f\n                const response = {\n                  request: xhr,\n                  status: xhr.status,\n                  data: JSON.parse(xhr.responseText),\n                };\n                resolve(response);\n              } else {\n                // \u54cd\u5e94\u5931\u8d25\n                console.log("error", xhr);\n                reject("error");\n              }\n            }\n          };\n          /*\n            \u901a\u5e38\u60c5\u51b5\u4e0b\uff1a\n              GET\u3001DELETE\u8bf7\u6c42\uff0c\u53ea\u4f1a\u6709\u67e5\u8be2\u5b57\u7b26\u4e32\u53c2\u6570\n              POST\u3001PUT\u3001PATCH\u8bf7\u6c42\uff0c\u65e2\u53ef\u4ee5\u6709\u8bf7\u6c42\u4f53\u53c2\u6570\uff0c\u4e5f\u53ef\u4ee5\u6709\u67e5\u8be2\u5b57\u7b26\u4e32\u53c2\u6570\n            params: { name: \'jack\', age: 18 } \n              --\x3e url?name=jack&age=18\n          */\n          let qs = "";\n          if (params) {\n            // \u63d0\u53d6params\u4e2d\u6240\u6709\u5c5e\u6027\u540d\u6210\u4e3a\u4e00\u4e2a\u6570\u7ec4\n            // [\'name\', \'age\']\n            qs = Object.keys(params)\n              .reduce((p, key) => {\n                const value = params[key];\n                return p + `${key}=${value}&`;\n              }, "?")\n              .slice(0, -1);\n          }\n\n          // 3. \u8bbe\u7f6e\u8bf7\u6c42\u4fe1\u606f\uff08\u8bf7\u6c42\u5730\u5740\u3001\u8bf7\u6c42\u65b9\u6cd5\u3002\u3002\u3002\uff09\n          xhr.open(method, url + qs);\n\n          let body = "";\n          if (\n            (method === "POST" || method === "PUT" || method === "PATCH") &&\n            data\n          ) {\n            // \u8bbe\u7f6e\u8bf7\u6c42\u5934\n            xhr.setRequestHeader("content-type", "application/json");\n            body = JSON.stringify(data);\n          }\n          // 4. \u53d1\u9001\u8bf7\u6c42\n          xhr.send(body);\n        });\n      }\n')),(0,a.kt)("h4",{id:"xhrstatus"},"xhr.status"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"2XX: \u8868\u793a\u6210\u529f\u5904\u7406\u8bf7\u6c42, \u5982200, 201"),(0,a.kt)("li",{parentName:"ul"},"3XX: \u9700\u8981\u751f\u5b9a\u5411, \u6d4f\u89c8\u5668\u76f4\u63a5\u8df3\u8f6c, \u5982302"),(0,a.kt)("li",{parentName:"ul"},"4XX: \u5ba2\u6237\u7aef\u8bf7\u6c42\u9519\u8bef, \u5982:  401, 404 "),(0,a.kt)("li",{parentName:"ul"},"5XX: \u670d\u52a1\u5668\u7aef\u9519\u8bef, \u5982: 500")),(0,a.kt)("h4",{id:"\u533a\u522bajax\u8bf7\u6c42\u4e0e\u4e00\u822chttp\u8bf7\u6c42"},"\u533a\u522bajax\u8bf7\u6c42\u4e0e\u4e00\u822cHTTP\u8bf7\u6c42"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"ajax\u8bf7\u6c42\u662f\u4e00\u79cd\u7279\u522b\u7684http\u8bf7\u6c42"),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u670d\u52a1\u5668\u7aef\u6765\u8bf4, \u6ca1\u6709\u4efb\u4f55\u533a\u522b, \u533a\u522b\u5728\u6d4f\u89c8\u5668\u7aef"),(0,a.kt)("li",{parentName:"ul"},"\u6d4f\u89c8\u5668\u7aef\u53d1\u8bf7\u6c42: \u53ea\u6709XHR\u6216fetch\u53d1\u51fa\u7684\u624d\u662fajax\u8bf7\u6c42, \u5176\u5b83\u6240\u6709\u7684\u90fd\u662f\u975eajax\u8bf7\u6c42"),(0,a.kt)("li",{parentName:"ul"},"\u6d4f\u89c8\u5668\u7aef\u63a5\u6536\u5230\u54cd\u5e94",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4e00\u822c\u8bf7\u6c42: \u6d4f\u89c8\u5668\u4e00\u822c\u4f1a\u76f4\u63a5\u663e\u793a\u54cd\u5e94\u4f53\u6570\u636e, \u4e5f\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u5237\u65b0/\u8df3\u8f6c\u9875\u9762"),(0,a.kt)("li",{parentName:"ul"},"ajax\u8bf7\u6c42: \u6d4f\u89c8\u5668\u4e0d\u4f1a\u5bf9\u754c\u9762\u8fdb\u884c\u4efb\u4f55\u66f4\u65b0\u64cd\u4f5c, \u53ea\u662f\u8c03\u7528\u76d1\u89c6\u7684\u56de\u8c03\u51fd\u6570\u5e76\u4f20\u5165\u54cd\u5e94\u76f8\u5173\u6570\u636e")))),(0,a.kt)("h4",{id:"\u5c01\u88c5\u4e00\u4e2a\u7b80\u6613\u7684ajax\u5f02\u6b65\u8bf7\u6c42\u51fd\u6570"},"\u5c01\u88c5\u4e00\u4e2a\u7b80\u6613\u7684ajax\u5f02\u6b65\u8bf7\u6c42\u51fd\u6570"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"/* \nxhr + promise \u5c01\u88c5\u4e00\u4e2a\u5f02\u6b65ajax\u8bf7\u6c42\u7684\u901a\u7528\u51fd\u6570  \u7b80\u6d01\u7248\n*/\nfunction ajax(url) {\n  return new Promise((resolve, reject) => {\n    // \u521b\u5efa\u4e00\u4e2aXHR\u5bf9\u8c61\n    const xhr = new XMLHttpRequest()\n    // \u521d\u59cb\u5316\u4e00\u4e2a\u5f02\u6b65\u8bf7\u6c42(\u8fd8\u6ca1\u53d1\u8bf7\u6c42)\n    xhr.open('GET', url, true)\n      \n    xhr.onreadystatechange = function () { \n        /*\n        ajax\u5f15\u64ce\u5f97\u5230\u54cd\u5e94\u6570\u636e\u540e\n            \u5c06xhr\u7684readyState\u5c5e\u6027\u6307\u5b9a\u4e3a4\n            \u5c06\u54cd\u5e94\u6570\u636e\u4fdd\u5b58\u5728response / responseText\u5c5e\u6027\u4e0a\n            \u8c03\u7528\u6b64\u56de\u8c03\u51fd\u6570\n        */\n        \n      // \u5982\u679c\u72b6\u6001\u503c\u4e0d\u4e3a4, \u76f4\u63a5\u7ed3\u675f(\u8bf7\u6c42\u8fd8\u6ca1\u6709\u7ed3\u675f)\n      if (xhr.readyState !== 4) {\n        return\n      }\n      // \u5982\u679c\u54cd\u5e94\u7801\u5728200~~299\u4e4b\u95f4, \u8bf4\u660e\u8bf7\u6c42\u90fd\u662f\u6210\u529f\u7684\n      if (xhr.status>=200 && xhr.status<300) {\n        // \u6307\u5b9apromise\u6210\u529f\u53ca\u7ed3\u679c\u503c\n        resolve(JSON.parse(xhr.responseText))\n      } else { // \u8bf7\u6c42\u5931\u8d25\u4e86\n        // \u6307\u5b9apromise\u5931\u8d25\u53ca\u7ed3\u679c\u503c\n        reject(new Error('request error staus '+ request.status))\n      }\n    }\n    xhr.send(null)\n  })\n}\n\n/* \nxhr + promise \u5c01\u88c5\u4e00\u4e2a\u5f02\u6b65ajax\u8bf7\u6c42\u7684\u901a\u7528\u51fd\u6570  \u52a0\u5f3a\u7248\n  \u8fd4\u56de\u503c: promise\n  \u53c2\u6570\u4e3a\u914d\u7f6e\u5bf9\u8c61\n    url: \u8bf7\u6c42\u5730\u5740\n    params: \u5305\u542b\u6240\u6709query\u8bf7\u6c42\u53c2\u6570\u7684\u5bf9\u8c61\n    data: \u5305\u542b\u6240\u6709\u8bf7\u6c42\u4f53\u53c2\u6570\u6570\u636e\u7684\u5bf9\u8c61\n    method: \u4e3a\u8bf7\u6c42\u65b9\u5f0f\n*/\nfunction axios({url, params={}, data={}, method='GET'}) {\n  // \u8fd4\u56de\u4e00\u4e2apromise\u5bf9\u8c61\n  return new Promise((resolve, reject) => {\n    // \u521b\u5efa\u4e00\u4e2aXHR\u5bf9\u8c61\n    const request = new XMLHttpRequest()\n    \n    // \u6839\u636eparams\u62fc\u63a5query\u53c2\u6570\n    let queryStr = Object.keys(params).reduce((pre, key) => {\n      pre += `&${key}=${params[key]}`\n      return pre\n    }, '')\n    if (queryStr.length>0) {\n      queryStr = queryStr.substring(1)\n      url += '?' + queryStr\n    }\n    // \u8bf7\u6c42\u65b9\u5f0f\u8f6c\u6362\u4e3a\u5927\u5199\n    method = method.toUpperCase()\n    \n    // \u521d\u59cb\u5316\u4e00\u4e2a\u5f02\u6b65\u8bf7\u6c42(\u8fd8\u6ca1\u53d1\u8bf7\u6c42)\n    request.open(method, url, true)\n    // \u7ed1\u5b9a\u8bf7\u6c42\u72b6\u6001\u6539\u53d8\u7684\u76d1\u542c\n    request.onreadystatechange = function () {\n      // \u5982\u679c\u72b6\u6001\u503c\u4e0d\u4e3a4, \u76f4\u63a5\u7ed3\u675f(\u8bf7\u6c42\u8fd8\u6ca1\u6709\u7ed3\u675f)\n      if (request.readyState !== 4) {\n        return\n      }\n      // \u5982\u679c\u54cd\u5e94\u7801\u5728200~~299\u4e4b\u95f4, \u8bf4\u660e\u8bf7\u6c42\u90fd\u662f\u6210\u529f\u7684\n      if (request.status>=200 && request.status<300) {\n        // \u51c6\u5907\u54cd\u5e94\u6570\u636e\u5bf9\u8c61\n        const responseData = {\n          data: JSON.parse(request.response),\n          status: request.status,\n          statusText: request.statusText\n        }\n        // \u6307\u5b9apromise\u6210\u529f\u53ca\u7ed3\u679c\u503c\n        resolve(responseData)\n      } else { // \u8bf7\u6c42\u5931\u8d25\u4e86\n        // \u6307\u5b9apromise\u5931\u8d25\u53ca\u7ed3\u679c\u503c\n        const error = new Error('request error staus '+ request.status)\n        reject(error)\n      }\n    }\n\n    // \u5982\u679c\u662fpost/put\u8bf7\u6c42\n    if (method==='POST' || method==='PUT' || method==='DELETE') {\n      // \u8bbe\u7f6e\u8bf7\u6c42\u5934: \u4f7f\u8bf7\u6c42\u4f53\u53c2\u6570\u4ee5json\u5f62\u5f0f\u4f20\u9012\n      request.setRequestHeader('Content-Type', 'application/json;charset=utf-8')\n      // \u5305\u542b\u6240\u6709\u8bf7\u6c42\u53c2\u6570\u7684\u5bf9\u8c61\u8f6c\u6362\u4e3ajson\u683c\u5f0f\n      const dataJson = JSON.stringify(data)\n      // \u53d1\u9001\u8bf7\u6c42, \u6307\u5b9a\u8bf7\u6c42\u4f53\u6570\u636e\n      request.send(dataJson)\n    } else {// GET\u8bf7\u6c42\n      // \u53d1\u9001\u8bf7\u6c42\n      request.send(null)\n    }\n  })\n}\n")),(0,a.kt)("h4",{id:"\u8de8\u57df"},"\u8de8\u57df"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4ec0\u4e48\u662f\u8de8\u57df(\u540c\u6e90\u7b56\u7565)"),(0,a.kt)("li",{parentName:"ul"},"JSONP"),(0,a.kt)("li",{parentName:"ul"},"CORS"),(0,a.kt)("li",{parentName:"ul"},"\u4ee3\u7406\u670d\u52a1\u5668")),(0,a.kt)("h4",{id:"\u540c\u6e90\u7b56\u7565"},"\u540c\u6e90\u7b56\u7565"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u540c\u6e90: \u534f\u8bae, \u57df\u540d, \u7aef\u53e3, \u4e09\u8005\u90fd\u76f8\u540c"),(0,a.kt)("li",{parentName:"ul"},"ajax\u8bf7\u6c42\u65f6, \u6d4f\u89c8\u5668\u8981\u6c42\u5f53\u524d\u7f51\u9875\u548cServer\u5fc5\u987b\u540c\u6e90(\u5b89\u5168), \u5426\u5219\u4f1a\u629b\u51fa\u8de8\u57df\u7684\u9519\u8bef"),(0,a.kt)("li",{parentName:"ul"},"\u52a0\u8f7dimage/link/script\u4e0d\u53d7\u540c\u6e90\u7b56\u7565\u9650\u5236")),(0,a.kt)("h4",{id:"jsonp\u539f\u7406"},"JSONP\u539f\u7406"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u524d\u53f0:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("script",{src:"\u76ee\u6807url?callback=fn"})),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u63a5\u6536\u54cd\u5e94\u6570\u636e\u7684\u51fd\u6570: function fn (data) {}")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u540e\u53f0"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5904\u7406\u8bf7\u6c42, \u4ea7\u751f\u9700\u8981\u8fd4\u56de\u7684\u6570\u636edata"),(0,a.kt)("li",{parentName:"ul"},"\u8bfb\u53d6callback\u8bf7\u6c42\u53c2\u6570\u5f97\u5230\u524d\u53f0\u5904\u7406\u54cd\u5e94\u6570\u636e\u7684\u51fd\u6570\u540dfn"),(0,a.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u6267\u884c\u51fd\u6570fn\u7684js\u4ee3\u7801: 'fn && fn(data)'"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u4e0d\u8db3"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u53ea\u80fd\u5904\u7406GET\u8bf7\u6c42"),(0,a.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u8bf7\u6c42\u5728\u540e\u53f0\u90fd\u8981\u505a\u5904\u7406, \u9ebb\u70e6")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// \u53d1\u9001jsonp\u8bf7\u6c42\u7684\u51fd\u6570\nfunction jsonp() {\n    var script = document.createElement('script')\n    script.type = 'text/javascript'\n    // \u4f20\u53c2\u5e76\u6307\u5b9a\u56de\u8c03\u6267\u884c\u51fd\u6570\u4e3abackFn\n    script.src = 'http://localhost:4000/getUserInfo?id=100&callback=fn'\n    document.body.appendChild(script)\n}\n\n// \u56de\u8c03\u51fd\u6570, \u63a5\u6536\u54cd\u5e94\u6570\u636e\nfunction fn(data) {\n    console.log(data)\n}\n")))),(0,a.kt)("h4",{id:"cors\u539f\u7406"},"CORS\u539f\u7406"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u540e\u53f0: \u8fd4\u56de\u5141\u8bb8\u6d4f\u89c8\u5668\u5728\u67d0\u4e2a\u57df\u4e0a\u53d1\u9001\u8de8\u57df\u8bf7\u6c42\u7684\u76f8\u5173\u54cd\u5e94\u5934")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// \u4f7f\u7528cors, \u5141\u8bb8\u8de8\u57df, \u4e14\u5141\u8bb8\u643a\u5e26\u8de8\u57dfcookie\napp.use(function (req, res, next) {\n  // console.log('----')\n  // \u5141\u8bb8\u8de8\u57df\u7684\u5730\u5740\n  res.header('Access-Control-Allow-Origin', 'http://localhost:5500')  // \u4e0d\u8981\u662f*\n  // \u5141\u8bb8\u643a\u5e26\u51ed\u8bc1(\u4e5f\u5c31\u662fcookie)\n  res.header('Access-Control-Allow-Credentials', 'true')\n  // \u5141\u8bb8\u8de8\u57df\u7684\u8bf7\u6c42\u5934\n  res.set(\"Access-Control-Allow-Headers\", \"Content-Type\")\n  // \u653e\u884c\n  next()\n})\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u524d\u53f0: \u4e0d\u9700\u8981\u505a\u7279\u522b\u4efb\u4f55\u5904\u7406")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios.defaults.withCredentials = true // \u5141\u8bb8\u643a\u5e26cookie\nxhr.withCredentials = true\n")),(0,a.kt)("h4",{id:"\u4ee3\u7406\u670d\u52a1\u5668"},"\u4ee3\u7406\u670d\u52a1\u5668"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5f00\u53d1\u73af\u5883: \u5229\u7528webpack-dev-server\u4e2d\u7684http-proxy-middle  \u8fdb\u884c\u6b63\u5411\u4ee3\u7406",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"vue\u811a\u624b\u67b6\u9879\u76ee"),(0,a.kt)("li",{parentName:"ul"},"react\u811a\u624b\u67b6\u9879\u76ee"),(0,a.kt)("li",{parentName:"ul"},"\u81ea\u5b9a\u4e49webpack\u914d\u7f6e"),(0,a.kt)("li",{parentName:"ul"},"\u76f4\u63a5\u4f7f\u7528http-proxy-middle\u914d\u7f6e"))),(0,a.kt)("li",{parentName:"ul"},"\u751f\u4ea7\u73af\u5883: \u5229\u7528nigix  \u8fdb\u884c\u53cd\u5411\u4ee3\u7406"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.cnblogs.com/taostaryu/p/10547132.html"},"https://www.cnblogs.com/taostaryu/p/10547132.html"))),(0,a.kt)("h4",{id:"\u4f7f\u7528axios\u53d1\u9001ajax\u8bf7\u6c42"},"\u4f7f\u7528axios\u53d1\u9001ajax\u8bf7\u6c42"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios(url)\naxios({\n    method: '',\n    url: '',  // \u5982\u679c\u6709params\u53c2\u6570\u5fc5\u987b\u62fc\u63a5\u5728url\u4e2d\n    params: {}, // query\u53c2\u6570\n    data: {} // \u8bf7\u6c42\u4f53\u53c2\u6570\n})\naxios.get(url, {\u914d\u7f6e})\naxios.post(url, data, {\u914d\u7f6e})\naxios.put(url, data, {\u914d\u7f6e})\naxios.delete(url, {\u914d\u7f6e})\n\nconst service = axios.create({\n    baseURL: '',\n    timeout: 20000,\n})\n\nservice.interceptors.request.use((config) => {\n    // \u6dfb\u52a0\u8bf7\u6c42\u5934\n    config.headers['token'] = token\u503c\n    return config // \u5fc5\u987b\u8fd4\u56deconfig\n})\n\nxhr.send()\n\nservice.interceptors.response.use(\n    response => {\n        // return response\n        return response.data\n    },\n    error => {\n        \n    }\n)\n\n\nservice({}).then(data => {\n    \n})\n\n\nPromise.resolve(config)\n    .then((config) => {  // \u8bf7\u6c42\u62e6\u622a\u5668\u7684\u56de\u8c03\n        return config\n    })  \n    .then((config) => { // \u7528\u6765\u53d1ajax\u7684\u56de\u8c03\n        return new Promise((resolve, reject) => {\n            // \u6839\u636econfig\u4f7f\u7528xhr\u53d1\u8bf7\u6c42\n            resolve(response)\n        })\n    })\n    .then(   // \u54cd\u5e94\u62e6\u622a\u5668\n        (response) => {\n            return response.data\n        }, \n        (error) => {\n            \n        }\n    )\n    .then((data) => { // \u6700\u7ec8\u53d1\u5177\u4f53\u8bf7\u6c42\u7684\u6210\u529f\u56de\u8c03\n    \n    })\n")),(0,a.kt)("h4",{id:"axios\u4e8c\u6b21\u5c01\u88c5"},"axios\u4e8c\u6b21\u5c01\u88c5"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u914d\u7f6e\u901a\u7528\u7684\u57fa\u7840\u8def\u5f84\u548c\u8d85\u65f6")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u663e\u793a\u8bf7\u6c42\u8fdb\u5ea6\u6761"),(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"\u663e\u793a\u8fdb\u5ea6\u6761: \u8bf7\u6c42\u62e6\u622a\u5668\u56de\u8c03"),(0,a.kt)("li",{parentName:"ol"},"\u7ed3\u675f\u8fdb\u5ea6\u6761: \u54cd\u5e94\u62e6\u622a\u5668\u56de\u8c03"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u6210\u529f\u8fd4\u56de\u7684\u6570\u636e\u4e0d\u518d\u662fresponse, \u800c\u76f4\u63a5\u662f\u54cd\u5e94\u4f53\u6570\u636eresponse.data")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u7edf\u4e00\u5904\u7406\u8bf7\u6c42\u9519\u8bef, \u5177\u4f53\u8bf7\u6c42\u4e5f\u53ef\u4ee5\u9009\u62e9\u5904\u7406\u6216\u4e0d\u5904\u7406")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u6bcf\u4e2a\u8bf7\u6c42\u81ea\u52a8\u643a\u5e26userTempId\u7684\u8bf7\u6c42\u5934: \u5728\u8bf7\u6c42\u62e6\u622a\u5668\u4e2d\u5b9e\u73b0")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5982\u679c\u5f53\u524d\u6709token, \u81ea\u52a8\u643a\u5e26token\u7684\u8bf7\u6c42\u5934")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5bf9token\u8fc7\u671f\u7684\u9519\u8bef\u8fdb\u884c\u5904\u7406"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import axios from 'axios'\nimport NProgress from 'nprogress'\nimport 'nprogress/nprogress.css'\nimport store from '@/store'\nimport router from '@/router'\n\nNProgress.configure({ showSpinner: false }) // \u9690\u85cf\u53f3\u4fa7\u7684\u65cb\u8f6c\u8fdb\u5ea6\u6761\n\n// \u521b\u5efainstance\nconst instance = axios.create({\n  // baseURL: 'http://182.92.128.115/api',\n  baseURL: '/api',\n  timeout: 20000\n})\n\n// \u6307\u5b9a\u8bf7\u6c42\u62e6\u622a\u5668\ninstance.interceptors.request.use(config => {\n  // \u663e\u793a\u8fdb\u5ea6\u6761: \u8bf7\u6c42\u62e6\u622a\u5668\u56de\u8c03\n  NProgress.start()\n\n  /* \u6bcf\u4e2a\u8bf7\u6c42\u81ea\u52a8\u643a\u5e26userTempId\u7684\u8bf7\u6c42\u5934: \u5728\u8bf7\u6c42\u62e6\u622a\u5668\u4e2d\u5b9e\u73b0 */\n  const userTempId = store.state.user.userTempId\n  config.headers.userTempId = userTempId\n  \n  /* 6. \u5982\u679c\u5f53\u524d\u6709token, \u81ea\u52a8\u643a\u5e26token\u7684\u8bf7\u6c42\u5934 */\n  const token = store.state.user.token\n  if (token) {\n    config.headers.token = token\n  }\n  \n  return config // \u5fc5\u987b\u8fd4\u56deconfig\n}) \n\n\n// \u6307\u5b9a\u54cd\u5e94\u62e6\u622a\u5668\ninstance.interceptors.response.use(\n  response => { // \u6210\u529f\u7684\u56de\u8c03\n    // \u7ed3\u675f\u8fdb\u5ea6\u6761: \u54cd\u5e94\u62e6\u622a\u5668\u56de\u8c03\n    NProgress.done()\n    // \u6210\u529f\u8fd4\u56de\u7684\u6570\u636e\u4e0d\u518d\u662fresponse,\xa0\u800c\u76f4\u63a5\u662f\u54cd\u5e94\u4f53\u6570\u636eresponse.data\n    return response.data\n  },\n\n  async error => { // \u5931\u8d25\u7684\u56de\u8c03\n    // \u7ed3\u675f\u8fdb\u5ea6\u6761: \u54cd\u5e94\u62e6\u622a\u5668\u56de\u8c03\n    NProgress.done()\n\n    // \u7edf\u4e00\u5904\u7406\u8bf7\u6c42\u9519\u8bef,\xa0\u5177\u4f53\u8bf7\u6c42\u4e5f\u53ef\u4ee5\u9009\u62e9\u5904\u7406\u6216\u4e0d\u5904\u7406\n    // alert('\u8bf7\u6c42\u51fa\u9519: ' + error.message||'\u672a\u77e5\u9519\u8bef')\n\n    // \u53d6\u51fa\u54cd\u5e94\u5bf9\u8c61\n    const { response } = error\n    // \u5982\u679c\u662f\u8bf7\u6c42\u5904\u7406\u51fa\u9519\n    if (response && response.status) {\n      // 401\u8bf4\u660etoken\u975e\u6cd5\n      if (response.status === 401) {\n        // \u5982\u679c\u5f53\u524d\u6ca1\u5728\u767b\u9646\u9875\n        if (router.currentRoute.path!=='/login') {\n          // \u5206\u53d1action\u53bb\u6e05\u9664\u7528\u6237token\u4fe1\u606f\n          await store.dispatch('logout')\n          // \u8df3\u8f6c\u5230\u767b\u9646\u9875\u9762\n          router.replace('/login')\n          // \u63d0\u793a\n          message.error('\u767b\u9646\u5df2\u8fc7\u671f, \u8bf7\u91cd\u65b0\u767b\u9646')\n        }\n      } else {\n        message.error('\u8bf7\u6c42\u51fa\u9519: ' + error.message||'\u672a\u77e5\u9519\u8bef')\n      }\n    } else if (!response) { // \u7f51\u7edc\u8fde\u63a5\u4e0d\u4e0a\u670d\u52a1\u5668\n      message.error('\u60a8\u7684\u7f51\u7edc\u53d1\u751f\u5f02\u5e38\uff0c\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668')\n    }\n\n    // throw error\n    return Promise.reject(error) // \u5c06\u9519\u8bef\u5411\u4e0b\u4f20\u9012\n  }\n)\n\n// \u5411\u5916\u66b4\u9732instance\nexport default instance\n")),(0,a.kt)("h4",{id:"restless-api-\u4e0e-restful-api"},"Restless API \u4e0e Restful API"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Restless API  "),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f20\u7edf\u7684API, \u628a\u6bcf\u4e2aurl\u5f53\u4f5c\u4e00\u4e2a\u529f\u80fd\u64cd\u4f5c      /deleteUser"),(0,a.kt)("li",{parentName:"ul"},"\u540c\u4e00\u4e2aurl, \u540e\u53f0\u53ea\u8fdb\u884cCRUD\u7684\u67d0\u4e00\u79cd\u64cd\u4f5c"),(0,a.kt)("li",{parentName:"ul"},"\u8bf7\u6c42\u65b9\u5f0f\u4e0d\u51b3\u5b9a\u8bf7\u6c42\u7684CRUD\u64cd\u4f5c"),(0,a.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u8bf7\u6c42\u8def\u5f84\u53ea\u5bf9\u5e94\u4e00\u4e2a\u64cd\u4f5c"),(0,a.kt)("li",{parentName:"ul"},"\u4e00\u822c\u53ea\u6709GET/POST"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Restful API "),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u65b0\u5f0f\u7684API, \u628a\u6bcf\u4e2aurl\u5f53\u4f5c\u4e00\u4e2a\u552f\u4e00\u8d44\u6e90   /user/2"),(0,a.kt)("li",{parentName:"ul"},"\u540c\u4e00\u4e2aurl, \u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7c7b\u578b\u7684\u8bf7\u6c42\u5bf9\u540e\u53f0\u8d44\u6e90\u6570\u636e\u8fdb\u884cCRUD\u56db\u79cd\u64cd\u4f5c"),(0,a.kt)("li",{parentName:"ul"},"\u8bf7\u6c42\u65b9\u5f0f\u6765\u51b3\u5b9a\u4e86\u8bf7\u6c42\u5728\u540e\u53f0\u8fdb\u884cCRUD\u7684\u54ea\u79cd\u64cd\u4f5c",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"GET: \u67e5\u8be2"),(0,a.kt)("li",{parentName:"ul"},"POST: \u6dfb\u52a0"),(0,a.kt)("li",{parentName:"ul"},"PUT: \u66f4\u65b0"),(0,a.kt)("li",{parentName:"ul"},"DELETE: \u5220\u9664"))),(0,a.kt)("li",{parentName:"ul"},"\u540c\u4e00\u4e2a\u8bf7\u6c42\u8def\u5f84\u53ef\u4ee5\u8fdb\u884c\u591a\u4e2a\u64cd\u4f5c"),(0,a.kt)("li",{parentName:"ul"},"\u8bf7\u6c42\u65b9\u5f0f\u4f1a\u7528\u5230GET/POST/PUT/DELETE"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u6d4b\u8bd5: \u53ef\u4ee5\u4f7f\u7528json-server\u5feb\u901f\u642d\u5efa\u6a21\u62df\u7684rest api \u63a5\u53e3"))))}c.isMDXComponent=!0}}]);